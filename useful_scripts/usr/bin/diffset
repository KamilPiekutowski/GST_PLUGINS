#!/usr/bin/python

import sys
from os import path

def app_to_array(option, diff_array, file1_array, file2_array, i, j):
    """ Appends line to array based on provided argument\n """
    """ i and j are current index that needs to be appended """

    if option == "xor" or option == "and":
        diff_array.append(file1_array[i])
        diff_array.append(file2_array[j])

    if option == "left":
        diff_array.append(file1_array[i])

    if option == "right":
        diff_array.append(file2_array[j])

def get_arguments():
    """ Parses option given at command line. Option must be\n """
    """ a first argument if not, then first and second argument """
    """ will be the manes for the files being compared """
    
    if sys.argv[1][0:2] != "--": #get first two character from the first arg
        return ("xor", sys.argv[2], sys.argv[3])

    if sys.argv[1][2:] == "xor": #inner set
        return ("xor", sys.argv[2], sys.argv[3])

    if sys.argv[1][2:] == "and": #outer set
        return ("and", sys.argv[2], sys.argv[3])

    if sys.argv[1][2:] == "left": #outer left
        return ("left", sys.argv[2], sys.argv[3])

    if sys.argv[1][2:] == "right": #outer right
        return ("right", sys.argv[2], sys.argv[3])

    return ("unknown", "","")


def main():
    if len(sys.argv) == 2 and sys.argv[1] == "--help":
        print("Usage: %s file1 file2" % sys.argv[0])
        print("List differences in between the lines of two files.")
        print("Differences are SORTED alfabetically.\n")
        quit()

    if len(sys.argv) < 3:
        print("Usage: %s file1 file2" % sys.argv[0])
        quit()

    (option, filename1, filename2) = get_arguments()

    if option == "unknown":
        printf("Unknown option %s" % argv[1])
        return

    file1_array = []
    file2_array = []

    if not path.exists(filename1):
        print("Cannot locate file \"%s\"." % filename1)
        quit()

    if not path.exists(filename2):
        print("Cannot locate file \"%s\"." % filename2)
        quit()

    with open(filename1) as file:
        for line in file:
            file1_array.append(line.rstrip("\n"))

    with open(filename2) as file:
        for line in file:
            file2_array.append(line.rstrip("\n"))

    #sorting two lists
    file1_array.sort()
    file2_array.sort()

    diff_array = []

    #compare two line and extract differences
    i = 0 #index for file1
    j = 0 #index for file2

    while i < len(file1_array) and j < len(file2_array):
        if file1_array[i] == file2_array[j]:
            if option == "and":
                app_to_array(option, diff_array,
                        file1_array, file2_array, i, j)

            i += 1
            j += 1

        elif file1_array[i] < file2_array[j]:
            if option != "and":
                app_to_array(option, diff_array,
                        file1_array, file2_array, i, j)

            i += 1

        elif file1_array[i] > file2_array[j]:
            if option != "and":
                app_to_array(option, diff_array,
                        file1_array, file2_array, i, j)

            j += 1

    temp = list(dict.fromkeys(diff_array))
    temp.sort()

    for elem in temp:
        print(elem);
        

main()
